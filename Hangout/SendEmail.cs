using SendGrid;
using System.Configuration;
using SendGrid.Helpers.Mail;
using System.Threading.Tasks;
namespace Hangout
{
    public class SendEmail
    {
        public Task SendOneEmail(string activationCode, string email, string firstName)
        {
            var myMessage = new SendGridMessage()
            {
                From = new EmailAddress("donotreply@wineoutlet.com", "WineOutlet"),
                Subject = "Wine Outlet Verification Mail",
                PlainTextContent = "Hello "+ firstName + "!",
                HtmlContent = "<html>   <head>      <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>      <title> Wine Outlet</title>      <meta name='viewport' content='width=device-width, initial-scale=1.0'/>   </head>   <body style='margin:0; padding:10px 0 0 0;' bgcolor='#ffffff'>      <div id='' class=''>         <div class=''>		 <table class='devicewidth' width='600' align='center' border='0' cellpadding='0' cellspacing='0'>                           <tbody>                              <tr>                                 <td height='50'> <p style='color:#444444; font-family:Open Sans, Arial, Helvetica, sans-serif; font-size:10px; font-weight:bold;text-align:center;'> *** This is an automatically generated email, please do not reply. *** </p> </td>                              </tr>                              <tr>                                 <td style='padding:0 20px;' data-bgcolor='heading-blue-bg' align='left' bgcolor=''>                                    <table width='128' align='left' border='0' cellpadding='0' cellspacing='0'>                                       <tbody>                                          <tr>                                             <td valign='middle' align='center'> <a href='http://www.wineoutlet.com/'><img src='https://icsintegration.blob.core.windows.net/barcodepp/wine-outlet-logo.png' alt='logo' height='' width='300'> </a> </td>                                          </tr>                                       </tbody>                                    </table>                                    <table width='145' align='right' border='0' cellpadding='0' cellspacing='0' style='margin-top: 5%;'>                                       <tbody>                                          <tr>                                             <td height='70' valign='middle' align='center'> 											 <a href='https://www.facebook.com/WineOutletNJ'><img src='https://icsintegration.blob.core.windows.net/barcodepp/facebook.png' alt='images' width='40'></a> <span>&nbsp;</span>                 											 <a href='https://twitter.com/WineOutletNJ'><img src='https://icsintegration.blob.core.windows.net/barcodepp/twitter.png' alt='images' width='40'></a> <span>&nbsp;</span>   											 <a href='http://www.wineoutlet.com/'><img src='https://icsintegration.blob.core.windows.net/barcodepp/website.png' alt='images' width='40'></a>																				         </td>                                          </tr>                                       </tbody>                                    </table>                                 </td>                              </tr>                              <tr>                                 <td style='padding:30px;' data-bgcolor='light-gray-bg' valign='top' align='center' bgcolor='#f8f8f8'>                                                                       <table width='100%' align='left' border='0' cellpadding='0' cellspacing='0'>                                       <tbody>                                          <tr>                                             <td style='color:#444444; font-family:Open Sans, Arial, Helvetica, sans-serif; font-size:18px; font-weight:bold; text-transform:uppercase;' data-size='heading-text' data-min='10' data-max='30' data-color='heading-color' align='left' contenteditable='false' class='editable'> Hello "+firstName+", </td>                                          </tr>                                          <tr>                                             <td>&nbsp;</td>                                          </tr>                                          <tr>                                             <td style='color:#444444; font-family:Open Sans, Arial, Helvetica, sans-serif; font-size:12px; line-height:25px;font-weight:bold;' data-size='body-text' data-min='10' data-max='25' data-color='body-text' align='left'>											 We are glad to have you onboarded with Wine Outlet! Please click the following link to activate your mobile app. </td>                                          </tr>                                                                                   <tr>                                             <td style='line-height:0;' valign='middle' align='middle'>  											 <a href='https://hangoutz.azurewebsites.net/VerificationPage.html?ActivationCode="+activationCode+"'><img src='https://icsintegration.blob.core.windows.net/barcodepp/activate.png' alt='images' style='border:none;' width='131'></a> &nbsp;                           																						 </td>                                          </tr>                                          <tr>                                             <td>&nbsp;</td>                                          </tr>                                          <tr>                                             <td style='color:#444444; font-family:Open Sans, Arial, Helvetica, sans-serif; font-size:12px; line-height:20px;font-weight:bold;' data-size='body-text' data-min='10' data-max='25' data-color='body-text' align='left'>											 Thank you, <br>Wine Outlet.</td>                                          </tr>                                       </tbody>                                    </table>                                 </td>                              </tr>                           </tbody>                        </table>         </div>               </div>   </body></html>"
            };
            //ActivationCode=" + activationCode) + 
            myMessage.AddTo(new EmailAddress(email, firstName));
            myMessage.AddBcc(new EmailAddress("mohana.indukuri@gmail.com", "Mohana"));
            var apiKey = ConfigurationManager.AppSettings["SENDGRID_APIKEY"];
            var client = new SendGridClient(apiKey);
            var response = client.SendEmailAsync(myMessage);
            return response;
        }
        public Task SendOneEmail(string email, string firstName)
        {
            var myMessage = new SendGridMessage()
            {
                From = new EmailAddress("donotreply@wineoutlet.com", "WineOutlet"),
                Subject = "Wine Outlet Invitation Mail",
                PlainTextContent = "Hello " + firstName + "!",
                HtmlContent = "<html>   <head>      <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>      <title> Wine Outlet</title>      <meta name='viewport' content='width=device-width, initial-scale=1.0'/>   </head>   <body style='margin:0; padding:10px 0 0 0;' bgcolor='#ffffff'>      <div id='' class=''>         <div class=''>		 <table class='devicewidth' width='600' align='center' border='0' cellpadding='0' cellspacing='0'>                           <tbody>                              <tr>                                 <td height='50'> <p style='color:#444444; font-family:Open Sans, Arial, Helvetica, sans-serif; font-size:10px; font-weight:bold;text-align:center;'> *** This is an automatically generated email, please do not reply. *** </p> </td>                              </tr>                              <tr>                                 <td style='padding:0 20px;' data-bgcolor='heading-blue-bg' align='left' bgcolor=''>                                    <table width='128' align='left' border='0' cellpadding='0' cellspacing='0'>                                       <tbody>                                          <tr>                                             <td valign='middle' align='center'> <a href='http://www.wineoutlet.com/'><img src='https://icsintegration.blob.core.windows.net/barcodepp/wine-outlet-logo.png' alt='logo' height='' width='300'> </a> </td>                                          </tr>                                       </tbody>                                    </table>                                    <table width='145' align='right' border='0' cellpadding='0' cellspacing='0' style='margin-top: 5%;'>                                       <tbody>                                          <tr>                                             <td height='70' valign='middle' align='center'> 											 <a href='https://www.facebook.com/WineOutletNJ'><img src='https://icsintegration.blob.core.windows.net/barcodepp/facebook.png' alt='images' width='40'></a> <span>&nbsp;</span>                 											 <a href='https://twitter.com/WineOutletNJ'><img src='https://icsintegration.blob.core.windows.net/barcodepp/twitter.png' alt='images' width='40'></a> <span>&nbsp;</span>   											 <a href='http://www.wineoutlet.com/'><img src='https://icsintegration.blob.core.windows.net/barcodepp/website.png' alt='images' width='40'></a>																				         </td>                                          </tr>                                       </tbody>                                    </table>                                 </td>                              </tr>                              <tr>                                 <td style='padding:30px;' data-bgcolor='light-gray-bg' valign='top' align='center' bgcolor='#f8f8f8'>                                                                       <table width='100%' align='left' border='0' cellpadding='0' cellspacing='0'>                                       <tbody>                                          <tr>                                             <td style='color:#444444; font-family:Open Sans, Arial, Helvetica, sans-serif; font-size:18px; font-weight:bold; text-transform:uppercase;' data-size='heading-text' data-min='10' data-max='30' data-color='heading-color' align='left' contenteditable='false' class='editable'> Welcome to Wine Outlet</td>                                          </tr>                                          <tr>                                             <td>&nbsp;</td>                                          </tr>                                          <tr>                                             <td style='color:#444444; font-family:Open Sans, Arial, Helvetica, sans-serif; font-size:13px; line-height:20px;font-weight:bold;' data-size='body-text' data-min='10' data-max='25' data-color='body-text' align='left'>											 Our exciting Wine Outlet mobile App lets you to view the wines available for free tastings </td>                                          </tr>                                          <tr>                                             <td>											 <ul><li style='color:#444444; font-family:Open Sans, Arial, Helvetica, sans-serif; font-size:13px; font-weight:bold;'>Rate </li><li style='color:#444444; font-family:Open Sans, Arial, Helvetica, sans-serif; font-size:13px; font-weight:bold;'> Review </li><li style='color:#444444; font-family:Open Sans, Arial, Helvetica, sans-serif; font-size:13px; font-weight:bold;'> View Tastings</li><li style='color:#444444; font-family:Open Sans, Arial, Helvetica, sans-serif; font-size:13px; font-weight:bold;'> Notifications </li><li style='color:#444444; font-family:Open Sans, Arial, Helvetica, sans-serif; font-size:13px; font-weight:bold;'> Promotions etc., </li></ul></td>                                          </tr>                                          <tr>                                             <td style='line-height:0;' valign='middle' align='left'>  											 <a href='https://itunes.apple.com/us/app/wine-outlet/id1208420358?mt=8'><img src='https://icsintegration.blob.core.windows.net/barcodepp/apple.png' alt='images' style='border:none;' width='131'></a> &nbsp;                           											 <a href='https://play.google.com/store/apps/details?id=com.savvyitsol.wineoulet&hl=en'><img src='https://icsintegration.blob.core.windows.net/barcodepp/playstore.png' alt='images' style='border:none;' width='131'></a>												 </td>                                          </tr>                                          <tr>                                             <td>&nbsp;</td>                                          </tr>                                          <tr>                                             <td style='color:#444444; font-family:Open Sans, Arial, Helvetica, sans-serif; font-size:13px; line-height:20px;font-weight:bold;' data-size='body-text' data-min='10' data-max='25' data-color='body-text' align='left'>											 Thank you, <br>Wine Outlet.</td>                                          </tr>                                       </tbody>                                    </table>                                 </td>                              </tr>                           </tbody>                        </table>         </div>               </div>   </body></html>"
            };
            //ActivationCode=" + activationCode) + 
            myMessage.AddTo(new EmailAddress(email, firstName));
            myMessage.AddBcc(new EmailAddress("mohana.indukuri@gmail.com", "Mohana"));
            myMessage.AddBcc(new EmailAddress("soumpunk@gmail.com", "Soumik"));
            myMessage.AddBcc(new EmailAddress("dubeyankur@gmail.com", "Ankur"));            
            var apiKey = ConfigurationManager.AppSettings["SENDGRID_REG_APIKEY"];
            var client = new SendGridClient(apiKey);
            var response = client.SendEmailAsync(myMessage);
            return response;
        }
    }
}